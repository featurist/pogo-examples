<html>
  <head>
    <title>Pogo Examples</title>
    <link rel="stylesheet" type="text/css" href="samples.css" />
    <link rel="stylesheet" type="text/css" href="highlight.css" />
  </head>
  <body>
    <a href="https://github.com/featurist/pogo-examples">
      <img style="position: absolute; top: 0; right: 0; border: 0;" src="http://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub" />
    </a>
    <h1>PogoScript to JavaScript Examples</h1>
    <ul>
      
      <li>
        <h2>Arrays</h2>
        <div class="pogo">
          <pre><code>array one <span class="operator">=</span> [<span class="number">1</span><span class="operator">,</span> <span class="string">"two"</span>]

array two <span class="operator">=</span> [
  <span class="number">3</span>
  <span class="string">"four"</span>
]</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> arrayOne, arrayTwo;

arrayOne = [ <span class="number">1</span>, <span class="string">"two"</span> ];

arrayTwo = [ <span class="number">3</span>, <span class="string">"four"</span> ];</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Blocks Preserve Self</h2>
        <div class="pogo">
          <pre><code>person <span class="operator">=</span> {

  name <span class="operator">=</span> <span class="string">'Man Ray'</span>

  say hi later() <span class="operator">=</span>
    set timeout
      console. log <span class="string">"my name is #(self.name)"</span>
    <span class="number">123</span>

}

not using an arrow
  means (<span class="keyword">self</span>) is not always (this)

using an arrow <span class="operator">=></span>
  means (<span class="keyword">self</span>) is always (this)</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> person;

person = {
    name: <span class="string">"Man Ray"</span>,
    sayHiLater: <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
        <span class="keyword">var</span> self;
        self = <span class="keyword">this</span>;
        <span class="keyword">return</span> setTimeout(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
            <span class="keyword">return</span> console.log(<span class="string">"my name is "</span> + self.name);
        }, <span class="number">123</span>);
    }
};

notUsingAnArrow(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> meansIsNotAlways(self, <span class="keyword">this</span>);
});

usingAnArrow(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">var</span> self;
    self = <span class="keyword">this</span>;
    <span class="keyword">return</span> meansIsAlways(self, <span class="keyword">this</span>);
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Closures</h2>
        <div class="pogo">
          <pre><code>map each @(filename) in (filenames) into @{ path. resolve (filename) }
    
map each @(filename) in (filenames) into
    path. resolve (filename)</code></pre>
        </div>
        <div class="javascript">
          <pre><code>mapEachInInto(filenames, <span class="function"><span class="keyword">function</span><span class="params">(filename)</span> {</span>
    <span class="keyword">return</span> path.resolve(filename);
});

mapEachInInto(filenames, <span class="function"><span class="keyword">function</span><span class="params">(filename)</span> {</span>
    <span class="keyword">return</span> path.resolve(filename);
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Declaring Functions</h2>
        <div class="pogo">
          <pre><code>one lower than (n) <span class="operator">=</span> n - <span class="number">1</span>

one higher than (n) <span class="operator">=</span>
  n + <span class="number">1</span>

either (thing) or (other) <span class="operator">=</span>
  thing || other

end of the line () <span class="operator">=</span>
  ok then()</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> oneLowerThan, oneHigherThan, eitherOr, endOfTheLine;

oneLowerThan = <span class="function"><span class="keyword">function</span><span class="params">(n)</span> {</span>
    <span class="keyword">return</span> n - <span class="number">1</span>;
};

oneHigherThan = <span class="function"><span class="keyword">function</span><span class="params">(n)</span> {</span>
    <span class="keyword">return</span> n + <span class="number">1</span>;
};

eitherOr = <span class="function"><span class="keyword">function</span><span class="params">(thing, other)</span> {</span>
    <span class="keyword">return</span> thing || other;
};

endOfTheLine = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> okThen();
};</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Factorial (Iterative)</h2>
        <div class="pogo">
          <pre><code>factorial (n) <span class="operator">=</span>
    x <span class="operator">=</span> <span class="number">1</span>
    <span class="keyword">for</span> (i <span class="operator">=</span> <span class="number">2</span><span class="operator">,</span> i &lt;<span class="operator">=</span> n<span class="operator">,</span> i <span class="operator">=</span> i + <span class="number">1</span>)
        x <span class="operator">=</span> x * i
  
    x</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> factorial;

factorial = <span class="function"><span class="keyword">function</span><span class="params">(n)</span> {</span>
    <span class="keyword">var</span> x, i;
    x = <span class="number">1</span>;
    <span class="keyword">for</span> (i = <span class="number">2</span>; i &lt;= n; i = i + <span class="number">1</span>) {
        x = x * i;
    }
    <span class="keyword">return</span> x;
};</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Factorial (Recursive)</h2>
        <div class="pogo">
          <pre><code>factorial (n) <span class="operator">=</span>
    <span class="keyword">if</span> (n <span class="operator">=</span><span class="operator">=</span> <span class="number">0</span>)
        <span class="number">1</span>
    <span class="keyword">else</span>
        n * factorial (n - <span class="number">1</span>)</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> factorial;

factorial = <span class="function"><span class="keyword">function</span><span class="params">(n)</span> {</span>
    <span class="keyword">if</span> (n === <span class="number">0</span>) {
        <span class="keyword">return</span> <span class="number">1</span>;
    } <span class="keyword">else</span> {
        <span class="keyword">return</span> n * factorial(n - <span class="number">1</span>);
    }
};</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Fibonacci</h2>
        <div class="pogo">
          <pre><code>fib (i) <span class="operator">=</span>
    <span class="keyword">if</span> ((i <span class="operator">=</span><span class="operator">=</span> <span class="number">0</span>) || (i <span class="operator">=</span><span class="operator">=</span> <span class="number">1</span>))
        <span class="number">1</span>
    <span class="keyword">else</span>
        fib (i - <span class="number">1</span>) + fib (i - <span class="number">2</span>)</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> fib;

fib = <span class="function"><span class="keyword">function</span><span class="params">(i)</span> {</span>
    <span class="keyword">if</span> (i === <span class="number">0</span> || i === <span class="number">1</span>) {
        <span class="keyword">return</span> <span class="number">1</span>;
    } <span class="keyword">else</span> {
        <span class="keyword">return</span> fib(i - <span class="number">1</span>) + fib(i - <span class="number">2</span>);
    }
};</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>For</h2>
        <div class="pogo">
          <pre><code><span class="keyword">for</span> (n <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> n &lt; <span class="number">10</span><span class="operator">,</span> n <span class="operator">=</span> n + <span class="number">1</span>)
  console. log (n)</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> n;

<span class="keyword">for</span> (n = <span class="number">0</span>; n &lt; <span class="number">10</span>; n = n + <span class="number">1</span>) {
    console.log(n);
}</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>For Each</h2>
        <div class="pogo">
          <pre><code><span class="keyword">for</span> each @(fruit) in (basket)
  gobble(fruit)</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> gen1_items, gen2_i, fruit;

gen1_items = basket;

<span class="keyword">for</span> (gen2_i = <span class="number">0</span>; gen2_i &lt; gen1_items.length; ++gen2_i) {
    fruit = gen1_items[gen2_i];
    gobble(fruit);
}</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Function Calls</h2>
        <div class="pogo">
          <pre><code>y <span class="operator">=</span> compute some value from (z) and return it

md5 hash (read all text from file <span class="string">"sample.txt"</span>)</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> y;

y = computeSomeValueFromAndReturnIt(z);

md5Hash(readAllTextFromFile(<span class="string">"sample.txt"</span>));</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Functions Without Arguments</h2>
        <div class="pogo">
          <pre><code>update page()
hungry <span class="operator">=</span> is lunch time()</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> hungry;

updatePage();

hungry = isLunchTime();</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>If</h2>
        <div class="pogo">
          <pre><code><span class="keyword">if</span> (wind speed > <span class="number">20</span>)
    console. log <span class="string">"gone kitesurfing!"</span>
<span class="keyword">else</span>
    console. log <span class="string">"no wind, programming"</span></code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">if</span> (windSpeed > <span class="number">20</span>) {
    console.log(<span class="string">"gone kitesurfing!"</span>);
} <span class="keyword">else</span> {
    console.log(<span class="string">"no wind, programming"</span>);
}</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Method Calls</h2>
        <div class="pogo">
          <pre><code>file <span class="operator">=</span> open file <span class="string">"README.md"</span>
file. read line()

open file <span class="string">"README.md"</span>. read line()</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> file;

file = openFile(<span class="string">"README.md"</span>);

file.readLine();

openFile(<span class="string">"README.md"</span>).readLine();</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Method Chains</h2>
        <div class="pogo">
          <pre><code>list. map @(i) into
    i + <span class="number">1</span>
.select @(i) <span class="keyword">if</span>
    i &lt; <span class="number">5</span>
.each @(i) <span class="keyword">do</span>
    console. log (i)
</code></pre>
        </div>
        <div class="javascript">
          <pre><code>list.mapInto(<span class="function"><span class="keyword">function</span><span class="params">(i)</span> {</span>
    <span class="keyword">return</span> i + <span class="number">1</span>;
}).selectIf(<span class="function"><span class="keyword">function</span><span class="params">(i)</span> {</span>
    <span class="keyword">return</span> i &lt; <span class="number">5</span>;
}).eachDo(<span class="function"><span class="keyword">function</span><span class="params">(i)</span> {</span>
    <span class="keyword">return</span> console.log(i);
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Multiline Functions</h2>
        <div class="pogo">
          <pre><code>item <span class="operator">=</span> <span class="number">0</span>

<span class="keyword">do</span>
    print (item)
    item <span class="operator">=</span> item + <span class="number">1</span>
<span class="keyword">while</span> @{ item &lt; <span class="number">10</span> }</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> item;

item = <span class="number">0</span>;

doWhile(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    print(item);
    <span class="keyword">return</span> item = item + <span class="number">1</span>;
}, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> item &lt; <span class="number">10</span>;
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Objects</h2>
        <div class="pogo">
          <pre><code>address <span class="operator">=</span> {
  street <span class="operator">=</span> <span class="string">"Fake Street"</span>
  post code <span class="operator">=</span> <span class="string">"123 ABC"</span>
}</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> address;

address = {
    street: <span class="string">"Fake Street"</span>,
    postCode: <span class="string">"123 ABC"</span>
};</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Operators</h2>
        <div class="pogo">
          <pre><code>total height <span class="operator">=</span> header + (item * count) + footer</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> totalHeight;

totalHeight = header + item * count + footer;</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Optional Arguments</h2>
        <div class="pogo">
          <pre><code>connect to mysql database (address<span class="operator">:</span> <span class="string">"1.2.3.4"</span><span class="operator">,</span> port<span class="operator">:</span> <span class="number">3307</span>)

connect to mysql database (readonly<span class="operator">:</span> <span class="literal">true</span>)
</code></pre>
        </div>
        <div class="javascript">
          <pre><code>connectToMysqlDatabase({
    address: <span class="string">"1.2.3.4"</span>,
    port: <span class="number">3307</span>
});

connectToMysqlDatabase({
    readonly: <span class="literal">true</span>
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Options</h2>
        <div class="pogo">
          <pre><code>connect to (port<span class="operator">:</span> <span class="number">3306</span><span class="operator">,</span> host<span class="operator">:</span> <span class="string">"127.0.0.1"</span>) <span class="operator">=</span>
  console.log <span class="string">"connecting to #(host):#(port)"</span>
</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> connectTo;

connectTo = <span class="function"><span class="keyword">function</span><span class="params">(gen1_options)</span> {</span>
    <span class="keyword">var</span> port, host;
    port = gen1_options &amp;&amp; gen1_options.hasOwnProperty(<span class="string">"port"</span>) &amp;&amp; gen1_options.port !== <span class="keyword">void</span> <span class="number">0</span> ? gen1_options.port : <span class="number">3306</span>;
    host = gen1_options &amp;&amp; gen1_options.hasOwnProperty(<span class="string">"host"</span>) &amp;&amp; gen1_options.host !== <span class="keyword">void</span> <span class="number">0</span> ? gen1_options.host : <span class="string">"127.0.0.1"</span>;
    <span class="keyword">return</span> console.log(<span class="string">"connecting to "</span> + host + <span class="string">":"</span> + port);
};</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Regular Expressions</h2>
        <div class="pogo">
          <pre><code><span class="string">"hot dog"</span>. replace r/d.g/ <span class="string">"potato"</span>

<span class="string">"FOO"</span>.match r/foo/gi</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="string">"hot dog"</span>.replace(<span class="regexp">/d.g/</span>, <span class="string">"potato"</span>);

<span class="string">"FOO"</span>.match(<span class="regexp">/foo/gi</span>);</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Splat Arguments</h2>
        <div class="pogo">
          <pre><code>foo (args<span class="operator">,</span> ...) <span class="operator">=</span>
     print (args)

foo <span class="number">1</span> [<span class="number">2</span><span class="operator">,</span> <span class="number">3</span>] ... [<span class="number">4</span><span class="operator">,</span> <span class="number">5</span>] ... <span class="number">6</span>
</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> foo;

foo = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">var</span> args;
    args = Array.prototype.slice.call(arguments, <span class="number">0</span>, arguments.length);
    <span class="keyword">return</span> print(args);
};

foo.apply(<span class="literal">null</span>, [ <span class="number">1</span> ].concat([ <span class="number">2</span>, <span class="number">3</span> ]).concat([ <span class="number">4</span>, <span class="number">5</span> ]).concat([ <span class="number">6</span> ]));</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Strings</h2>
        <div class="pogo">
          <pre><code><span class="string">'meet you at Jayne''s place'</span>

alan kay <span class="operator">=</span> <span class="string">"The best way to predict the future
            is to invent it."</span>

mood <span class="operator">=</span> <span class="string">"happy"</span>
announce <span class="string">"Feeling #(mood) today"</span>
</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> alanKay, mood;

<span class="string">"meet you at Jayne's place"</span>;

alanKay = <span class="string">"The best way to predict the future\nis to invent it."</span>;

mood = <span class="string">"happy"</span>;

announce(<span class="string">"Feeling "</span> + mood + <span class="string">" today"</span>);</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Try Catch</h2>
        <div class="pogo">
          <pre><code>try
    something messy()
catch (ex)
    console.log <span class="string">"it went horribly wrong"</span>
finally
    better clean up()</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">try</span> {
    somethingMessy();
} <span class="keyword">catch</span> (ex) {
    console.log(<span class="string">"it went horribly wrong"</span>);
} <span class="keyword">finally</span> {
    betterCleanUp();
}</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Variables</h2>
        <div class="pogo">
          <pre><code>height <span class="operator">=</span> <span class="number">1025</span>

height <span class="operator">=</span>
  n <span class="operator">=</span> <span class="number">10</span>
  (n * n * n) + <span class="number">25</span>
</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> height;

height = <span class="number">1025</span>;

height = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">var</span> n;
    n = <span class="number">10</span>;
    <span class="keyword">return</span> n * n * n + <span class="number">25</span>;
}();</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Web Server</h2>
        <div class="pogo">
          <pre><code>http <span class="operator">=</span> require <span class="string">'http'</span>
http. create server @(request<span class="operator">,</span> response)
    response. write (head<span class="operator">:</span> <span class="number">200</span><span class="operator">,</span> <span class="string">"Content-Type"</span><span class="operator">:</span> <span class="string">"text/plain"</span>)
    response. end <span class="string">"Hello World\n"</span>
. listen <span class="number">1337</span></code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> http;

http = require(<span class="string">"http"</span>);

http.createServer(<span class="function"><span class="keyword">function</span><span class="params">(request, response)</span> {</span>
    response.write({
        head: <span class="number">200</span>,
        <span class="string">"Content-Type"</span>: <span class="string">"text/plain"</span>
    });
    <span class="keyword">return</span> response.end(<span class="string">"Hello World\n"</span>);
}).listen(<span class="number">1337</span>);</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>When</h2>
        <div class="pogo">
          <pre><code>is (expected) (action) <span class="operator">=</span>
    action <span class="keyword">if</span> (actual) matched <span class="operator">=</span>
        <span class="keyword">if</span> (expected <span class="operator">=</span><span class="operator">=</span> actual)
            action

otherwise (action) <span class="operator">=</span>
    action <span class="keyword">if</span> (actual) matched <span class="operator">=</span>
        action

when (actual<span class="operator">,</span> cases) <span class="operator">=</span>
    <span class="keyword">for</span> each @(action <span class="keyword">if</span> matched) in (cases)
        action <span class="operator">=</span> action <span class="keyword">if</span> (actual) matched
        <span class="keyword">if</span> (action)
            return (action ())

print (args<span class="operator">,</span> ...) <span class="operator">=</span> console.log (args<span class="operator">,</span> ...)

x <span class="operator">=</span> <span class="number">2</span>

when (x) [
    is <span class="number">0</span>
        print <span class="string">"x is zero"</span>

    is <span class="number">1</span>
        print <span class="string">"x is one"</span>

    otherwise
        print <span class="string">"x is not zero or one"</span>
]</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> is, otherwise, when, print, x;

is = <span class="function"><span class="keyword">function</span><span class="params">(expected, action)</span> {</span>
    <span class="keyword">var</span> actionIfMatched;
    <span class="keyword">return</span> actionIfMatched = <span class="function"><span class="keyword">function</span><span class="params">(actual)</span> {</span>
        <span class="keyword">if</span> (expected === actual) {
            <span class="keyword">return</span> action;
        }
    };
};

otherwise = <span class="function"><span class="keyword">function</span><span class="params">(action)</span> {</span>
    <span class="keyword">var</span> actionIfMatched;
    <span class="keyword">return</span> actionIfMatched = <span class="function"><span class="keyword">function</span><span class="params">(actual)</span> {</span>
        <span class="keyword">return</span> action;
    };
};

when = <span class="function"><span class="keyword">function</span><span class="params">(actual, cases)</span> {</span>
    <span class="keyword">var</span> gen1_items, gen2_i, gen3_forResult;
    gen1_items = <span class="keyword">case</span>s;
    <span class="keyword">for</span> (gen2_i = <span class="number">0</span>; gen2_i &lt; gen1_items.length; ++gen2_i) {
        gen3_forResult = <span class="keyword">void</span> <span class="number">0</span>;
        <span class="keyword">if</span> (<span class="function"><span class="keyword">function</span><span class="params">(gen2_i)</span> {</span>
            <span class="keyword">var</span> actionIfMatched, action;
            actionIfMatched = gen1_items[gen2_i];
            action = actionIfMatched(actual);
            <span class="keyword">if</span> (action) {
                gen3_forResult = action();
                <span class="keyword">return</span> <span class="literal">true</span>;
            }
        }(gen2_i)) {
            <span class="keyword">return</span> gen3_forResult;
        }
    }
};

print = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">var</span> args, gen4_o;
    args = Array.prototype.slice.call(arguments, <span class="number">0</span>, arguments.length);
    gen4_o = console;
    <span class="keyword">return</span> gen4_o.log.apply(gen4_o, args);
};

x = <span class="number">2</span>;

when(x, [ is(<span class="number">0</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> print(<span class="string">"x is zero"</span>);
}), is(<span class="number">1</span>, <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> print(<span class="string">"x is one"</span>);
}), otherwise(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
    <span class="keyword">return</span> print(<span class="string">"x is not zero or one"</span>);
}) ]);</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Async Calls</h2>
        <div class="pogo">
          <pre><code>web page <span class="operator">=</span> http.get! <span class="string">"http://www.interesting.com"</span>
scrape facts from (web page)</code></pre>
        </div>
        <div class="javascript">
          <pre><code>http.get(<span class="string">"http://www.interesting.com"</span>, <span class="function"><span class="keyword">function</span><span class="params">(gen1_error, gen2_asyncResult)</span> {</span>
    <span class="keyword">var</span> webPage;
    <span class="keyword">if</span> (gen1_error) {
        gen3_callback(gen1_error);
    } <span class="keyword">else</span> {
        <span class="keyword">try</span> {
            webPage = gen2_asyncResult;
            gen3_callback(<span class="keyword">void</span> <span class="number">0</span>, scrapeFactsFrom(webPage));
        } <span class="keyword">catch</span> (gen4_exception) {
            gen3_callback(gen4_exception);
        }
    }
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Async For</h2>
        <div class="pogo">
          <pre><code><span class="keyword">for</span> (n <span class="operator">=</span> <span class="number">0</span><span class="operator">,</span> n &lt; <span class="number">3</span><span class="operator">,</span> n <span class="operator">=</span> n + <span class="number">1</span>)
  send letter! (n)

all letters sent()</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> gen1_asyncFor;

gen1_asyncFor = <span class="function"><span class="keyword">function</span><span class="params">(test, incr, loop, cb)</span> {</span>
    <span class="keyword">try</span> {
        <span class="keyword">var</span> testAndLoop = <span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>
            test(<span class="function"><span class="keyword">function</span><span class="params">(error, anotherLoop)</span> {</span>
                <span class="keyword">if</span> (error) {
                    cb(error);
                } <span class="keyword">else</span> {
                    <span class="keyword">if</span> (anotherLoop) {
                        loop(incrTestAndLoop);
                    } <span class="keyword">else</span> {
                        cb();
                    }
                }
            });
        };
        <span class="keyword">var</span> incrTestAndLoop = <span class="function"><span class="keyword">function</span><span class="params">(error)</span> {</span>
            <span class="keyword">if</span> (error) {
                cb(error);
            } <span class="keyword">else</span> {
                incr(<span class="function"><span class="keyword">function</span><span class="params">(error)</span> {</span>
                    <span class="keyword">if</span> (error) {
                        cb(error);
                    } <span class="keyword">else</span> {
                        testAndLoop();
                    }
                });
            }
        };
        testAndLoop();
    } <span class="keyword">catch</span> (error) {
        cb(error);
    }
};

(<span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
    <span class="keyword">var</span> n;
    n = <span class="number">0</span>;
    gen1_asyncFor(<span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
        gen2_callback(<span class="keyword">void</span> <span class="number">0</span>, n &lt; <span class="number">3</span>);
    }, <span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
        gen2_callback(<span class="keyword">void</span> <span class="number">0</span>, n = n + <span class="number">1</span>);
    }, <span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
        sendLetter(n, gen2_callback);
    }, gen2_callback);
})(<span class="function"><span class="keyword">function</span><span class="params">(gen3_error, gen4_asyncResult)</span> {</span>
    <span class="keyword">if</span> (gen3_error) {
        gen2_callback(gen3_error);
    } <span class="keyword">else</span> {
        <span class="keyword">try</span> {
            gen4_asyncResult;
            gen2_callback(<span class="keyword">void</span> <span class="number">0</span>, allLettersSent());
        } <span class="keyword">catch</span> (gen5_exception) {
            gen2_callback(gen5_exception);
        }
    }
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Async Fork</h2>
        <div class="pogo">
          <pre><code>fs <span class="operator">=</span> require <span class="string">'fs'</span>

fork (block) <span class="operator">=</span> block @{}

fork
    console.log <span class="string">"reading contents of file #(__filename)"</span>
    contents <span class="operator">=</span> fs.read file (__filename<span class="operator">,</span>  <span class="string">'utf-8'</span>)!
    console.log (<span class="string">"contents of #(__filename):"</span>)
    process.stdout.write (contents)

console.log <span class="string">'processing other stuff'</span></code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> fs, fork;

fs = require(<span class="string">"fs"</span>);

fork = <span class="function"><span class="keyword">function</span><span class="params">(block)</span> {</span>
    <span class="keyword">return</span> block(<span class="function"><span class="keyword">function</span><span class="params">()</span> {</span>});
};

fork(<span class="function"><span class="keyword">function</span><span class="params">(gen1_callback)</span> {</span>
    console.log(<span class="string">"reading contents of file "</span> + __filename);
    fs.readFile(__filename, <span class="string">"utf-8"</span>, <span class="function"><span class="keyword">function</span><span class="params">(gen2_error, gen3_asyncResult)</span> {</span>
        <span class="keyword">var</span> contents;
        <span class="keyword">if</span> (gen2_error) {
            gen1_callback(gen2_error);
        } <span class="keyword">else</span> {
            <span class="keyword">try</span> {
                contents = gen3_asyncResult;
                console.log(<span class="string">"contents of "</span> + __filename + <span class="string">":"</span>);
                gen1_callback(<span class="keyword">void</span> <span class="number">0</span>, process.stdout.write(contents));
            } <span class="keyword">catch</span> (gen4_exception) {
                gen1_callback(gen4_exception);
            }
        }
    });
});

console.log(<span class="string">"processing other stuff"</span>);</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Async If</h2>
        <div class="pogo">
          <pre><code><span class="keyword">if</span> ((intruders) are dangerous)
  kill! (intruders)
<span class="keyword">else</span>
  call the cops about! (intruders)
  
keep watch!</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> gen1_asyncIfElse;

gen1_asyncIfElse = <span class="function"><span class="keyword">function</span><span class="params">(condition, thenBody, elseBody, cb)</span> {</span>
    <span class="keyword">if</span> (condition) {
        <span class="keyword">try</span> {
            thenBody(cb);
        } <span class="keyword">catch</span> (ex) {
            cb(ex);
        }
    } <span class="keyword">else</span> {
        <span class="keyword">try</span> {
            elseBody(cb);
        } <span class="keyword">catch</span> (ex) {
            cb(ex);
        }
    }
};

gen1_asyncIfElse(areDangerous(intruders), <span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
    kill(intruders, gen2_callback);
}, <span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
    callTheCopsAbout(intruders, gen2_callback);
}, <span class="function"><span class="keyword">function</span><span class="params">(gen3_error, gen4_asyncResult)</span> {</span>
    <span class="keyword">if</span> (gen3_error) {
        gen2_callback(gen3_error);
    } <span class="keyword">else</span> {
        <span class="keyword">try</span> {
            gen4_asyncResult;
            keepWatch(gen2_callback);
        } <span class="keyword">catch</span> (gen5_exception) {
            gen2_callback(gen5_exception);
        }
    }
});</code></pre>
        </div>
        <hr />
      </li>
      
      <li>
        <h2>Async Try Catch</h2>
        <div class="pogo">
          <pre><code>record <span class="operator">=</span> nil

try
  database <span class="operator">=</span> connect to the database! 
  record <span class="operator">=</span> database.query!
catch (error)
  exit the program because of (error)!
finally
  database.close!

console.log(<span class="string">"RECORD FOUND: #(record)"</span>)</code></pre>
        </div>
        <div class="javascript">
          <pre><code><span class="keyword">var</span> gen1_asyncTry, record;

gen1_asyncTry = <span class="function"><span class="keyword">function</span><span class="params">(body, catchBody, finallyBody, cb)</span> {</span>
    <span class="keyword">var</span> callbackCalled = <span class="literal">false</span>;
    <span class="keyword">var</span> callback = <span class="function"><span class="keyword">function</span><span class="params">(error, result)</span> {</span>
        <span class="keyword">if</span> (!callbackCalled) {
            callbackCalled = <span class="literal">true</span>;
            cb(error, result);
        }
    };
    <span class="keyword">try</span> {
        body(<span class="function"><span class="keyword">function</span><span class="params">(error, result)</span> {</span>
            <span class="keyword">if</span> (error) {
                <span class="keyword">if</span> (finallyBody &amp;&amp; catchBody) {
                    <span class="keyword">try</span> {
                        catchBody(error, <span class="function"><span class="keyword">function</span><span class="params">(error, result)</span> {</span>
                            <span class="keyword">try</span> {
                                finallyBody(<span class="function"><span class="keyword">function</span><span class="params">(finallyError)</span> {</span>
                                    callback(finallyError || error, finallyError || error ? undefined : result);
                                });
                            } <span class="keyword">catch</span> (error) {
                                callback(error);
                            }
                        });
                    } <span class="keyword">catch</span> (error) {
                        <span class="keyword">try</span> {
                            finallyBody(<span class="function"><span class="keyword">function</span><span class="params">(finallyError)</span> {</span>
                                callback(finallyError || error);
                            });
                        } <span class="keyword">catch</span> (error) {
                            callback(error);
                        }
                    }
                } <span class="keyword">else</span> <span class="keyword">if</span> (catchBody) {
                    <span class="keyword">try</span> {
                        catchBody(error, callback);
                    } <span class="keyword">catch</span> (error) {
                        callback(error);
                    }
                } <span class="keyword">else</span> {
                    <span class="keyword">try</span> {
                        finallyBody(<span class="function"><span class="keyword">function</span><span class="params">(finallyError)</span> {</span>
                            callback(finallyError || error, finallyError ? undefined : result);
                        });
                    } <span class="keyword">catch</span> (error) {
                        callback(error);
                    }
                }
            } <span class="keyword">else</span> {
                <span class="keyword">if</span> (finallyBody) {
                    <span class="keyword">try</span> {
                        finallyBody(<span class="function"><span class="keyword">function</span><span class="params">(finallyError)</span> {</span>
                            callback(finallyError, finallyError ? undefined : result);
                        });
                    } <span class="keyword">catch</span> (error) {
                        callback(error);
                    }
                } <span class="keyword">else</span> {
                    callback(undefined, result);
                }
            }
        });
    } <span class="keyword">catch</span> (error) {
        <span class="keyword">if</span> (finallyBody &amp;&amp; catchBody) {
            <span class="keyword">try</span> {
                catchBody(error, <span class="function"><span class="keyword">function</span><span class="params">(error, result)</span> {</span>
                    <span class="keyword">try</span> {
                        finallyBody(<span class="function"><span class="keyword">function</span><span class="params">(finallyError)</span> {</span>
                            callback(finallyError || error, finallyError ? undefined : result);
                        });
                    } <span class="keyword">catch</span> (error) {
                        callback(error);
                    }
                });
            } <span class="keyword">catch</span> (error) {
                <span class="keyword">try</span> {
                    finallyBody(<span class="function"><span class="keyword">function</span><span class="params">(finallyError)</span> {</span>
                        callback(finallyError || error);
                    });
                } <span class="keyword">catch</span> (error) {
                    callback(error);
                }
            }
        } <span class="keyword">else</span> <span class="keyword">if</span> (catchBody) {
            <span class="keyword">try</span> {
                catchBody(error, callback);
            } <span class="keyword">catch</span> (error) {
                callback(error);
            }
        } <span class="keyword">else</span> {
            <span class="keyword">try</span> {
                finallyBody(<span class="function"><span class="keyword">function</span><span class="params">(finallyError)</span> {</span>
                    callback(finallyError || error);
                });
            } <span class="keyword">catch</span> (error) {
                callback(error);
            }
        }
    }
};

record = <span class="keyword">void</span> <span class="number">0</span>;

gen1_asyncTry(<span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
    connectToTheDatabase(<span class="function"><span class="keyword">function</span><span class="params">(gen3_error, gen4_asyncResult)</span> {</span>
        <span class="keyword">var</span> database;
        <span class="keyword">if</span> (gen3_error) {
            gen2_callback(gen3_error);
        } <span class="keyword">else</span> {
            <span class="keyword">try</span> {
                database = gen4_asyncResult;
                database.query(<span class="function"><span class="keyword">function</span><span class="params">(gen5_error, gen6_asyncResult)</span> {</span>
                    <span class="keyword">if</span> (gen5_error) {
                        gen2_callback(gen5_error);
                    } <span class="keyword">else</span> {
                        <span class="keyword">try</span> {
                            gen2_callback(<span class="keyword">void</span> <span class="number">0</span>, record = gen6_asyncResult);
                        } <span class="keyword">catch</span> (gen7_exception) {
                            gen2_callback(gen7_exception);
                        }
                    }
                });
            } <span class="keyword">catch</span> (gen8_exception) {
                gen2_callback(gen8_exception);
            }
        }
    });
}, <span class="function"><span class="keyword">function</span><span class="params">(error, gen2_callback)</span> {</span>
    exitTheProgramBecauseOf(error, gen2_callback);
}, <span class="function"><span class="keyword">function</span><span class="params">(gen2_callback)</span> {</span>
    database.close(gen2_callback);
}, <span class="function"><span class="keyword">function</span><span class="params">(gen9_error, gen10_asyncResult)</span> {</span>
    <span class="keyword">if</span> (gen9_error) {
        gen2_callback(gen9_error);
    } <span class="keyword">else</span> {
        <span class="keyword">try</span> {
            gen10_asyncResult;
            gen2_callback(<span class="keyword">void</span> <span class="number">0</span>, console.log(<span class="string">"RECORD FOUND: "</span> + record));
        } <span class="keyword">catch</span> (gen11_exception) {
            gen2_callback(gen11_exception);
        }
    }
});</code></pre>
        </div>
        <hr />
      </li>
      
    </ul>
    
  </body>
</html>
